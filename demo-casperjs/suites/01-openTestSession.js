casper.test.comment("Opening session functional tests");

casper.start("http://"+casper.cli.options.domain, function() {

    this.test.assertTitle("Devoxx Basic Evaluation App");

    this.test.assertExists('#mainContainer input[name="session"]', "A text input to enter session should be present");

});

casper.then(function() {

    this.fill('#sessionFormContainer form', {
        'session': 'TEST'
    }, false);

    this.click('#sessionFormContainer form button[type="submit"]');

    this.waitForSelector('#attendeesContainer'); // Wait table
});

casper.then(function() {

    helpers.capture("participants-for-test-session"); // Take a screenshot

    this.test.assertEvalEquals(function() {
        return $('table tr').size();
    }, 30, 'Attendees table contains 30 rows');
});

casper.run(function() {
    this.test.done();
});
